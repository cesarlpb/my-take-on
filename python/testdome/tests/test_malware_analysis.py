import pytest
from ..malware_analysis import simulate

def test_should_modify_three_ints():
  records, s = [ 4, 1, 3, 5, 4, 7, 9 ], 3
  expected = [ -1, -1, -1, 5, -1, -1, -1 ]
  assert simulate(records, s) == expected

def test_should_modify_two_ints():
  records, s = [ 7, 6, 9, 1, 8, 3, 2 ], 2
  expected = [-1, -1, 9, 1, 8, -1, -1]
  assert simulate(records, s) == expected
  
def test_should_raise_value_error():
  with pytest.raises(ValueError, match="s cannot be larger than array length"):
    simulate([1, 2, 3], 10)
    
def test_should_return_empty_list():
  records, s = [], 0
  assert simulate(records, s) == []